====== Report for Rasca Security alerts ======

**DO NOT EDIT THIS PAGE. It is generated by modularit-inventory chef cookbook. Any changes will be overwriten on next run**

===== SecPkgChk =====

^ Host ^ Status ^ Last Update ^ Last Change ^ Last Message ^
<% @nodes.each do |n| =%>
<%  if n.has_key?('rasca_status') and n['rasca_status']['SecPkgChk'] and n['rasca_status']['SecPkgChk']['CheckSecPkg']
      @last_status=n['rasca_status']['SecPkgChk']['CheckSecPkg'].has_key?('last_status') ? n['rasca_status']['SecPkgChk']['CheckSecPkg']['last_status'] : "Unknown"
      @last_status="**#{@last_status}**" if @last_status != "OK"
      @last_change=n['rasca_status']['SecPkgChk']['CheckSecPkg'].has_key?('status_last_change') ? n['rasca_status']['SecPkgChk']['CheckSecPkg']['status_last_change'] : "Unknown"
      @last_updated=n['rasca_status']['SecPkgChk']['CheckSecPkg'].has_key?('ctime') ? n['rasca_status']['SecPkgChk']['CheckSecPkg']['ctime'] : "Unknown"
      @last_message=n['rasca_status']['SecPkgChk']['CheckSecPkg'].has_key?('last_message') ? n['rasca_status']['SecPkgChk']['CheckSecPkg']['last_message'] : "Unknown"
-%>
| <%= n.name %> | <%= @last_status %> | <%= @last_updated %> | <%= @last_change %> | <%= @last_message %> |
<%  end -%>
<% end -%>

===== SecPassChk =====

^ Host ^ Status ^ Last Update ^ Last Change ^ Last Message ^
<% @nodes.each do |n| =%>
<%  if n.has_key?('rasca_status') and n['rasca_status']['SecPassChk'] and n['rasca_status']['SecPassChk']['CheckSecUsers']
      @last_status=n['rasca_status']['SecPassChk']['CheckSecUsers'].has_key?('last_status') ? n['rasca_status']['SecPassChk']['CheckSecUsers']['last_status'] : "Unknown"
      @last_status="**#{@last_status}**" if @last_status != "OK"
      @last_change=n['rasca_status']['SecPassChk']['CheckSecUsers'].has_key?('status_last_change') ? n['rasca_status']['SecPassChk']['CheckSecUsers']['status_last_change'] : "Unknown"
      @last_updated=n['rasca_status']['SecPassChk']['CheckSecUsers'].has_key?('ctime') ? n['rasca_status']['SecPassChk']['CheckSecUsers']['ctime'] : "Unknown"
      @last_message=n['rasca_status']['SecPassChk']['CheckSecUsers'].has_key?('last_message') ? n['rasca_status']['SecPassChk']['CheckSecUsers']['last_message'] : "Unknown"
-%>
| <%= n.name %> | <%= @last_status %> | <%= @last_updated %> | <%= @last_change %> | <%= @last_message %> |
<%  end -%>
<% end -%>

===== TWChk =====

^ Host ^ Status ^ Last Update ^ Last Change ^ Last Message ^
<% @nodes.each do |n| =%>
<%  if n.has_key?('rasca_status') and n['rasca_status']['TWChk'] and n['rasca_status']['TWChk']['CheckTripwire']
      @last_status=n['rasca_status']['TWChk']['CheckTripwire'].has_key?('last_status') ? n['rasca_status']['TWChk']['CheckTripwire']['last_status'] : "Unknown"
      @last_status="**#{@last_status}**" if @last_status != "OK"
      @last_change=n['rasca_status']['TWChk']['CheckTripwire'].has_key?('status_last_change') ? n['rasca_status']['TWChk']['CheckTripwire']['status_last_change'] : "Unknown"
      @last_updated=n['rasca_status']['TWChk']['CheckTripwire'].has_key?('ctime') ? n['rasca_status']['TWChk']['CheckTripwire']['ctime'] : "Unknown"
      @last_message=n['rasca_status']['TWChk']['CheckTripwire'].has_key?('last_message') ? n['rasca_status']['TWChk']['CheckTripwire']['last_message'] : "Unknown"
-%>
| <%= n.name %> | <%= @last_status %> | <%= @last_updated %> | <%= @last_change %> | <%= @last_message %> |
<%  end -%>
<% end -%>

===== GitChk =====

^ Host ^ Status ^ Last Update ^ Last Change ^ Last Message ^
<% @nodes.each do |n| =%>
<%  if n.has_key?('rasca_status') and n['rasca_status']['GitChk'] and n['rasca_status']['GitChk']['CheckGit']
      @last_status=n['rasca_status']['GitChk']['CheckGit'].has_key?('last_status') ? n['rasca_status']['GitChk']['CheckGit']['last_status'] : "Unknown"
      @last_status="**#{@last_status}**" if @last_status != "OK"
      @last_change=n['rasca_status']['GitChk']['CheckGit'].has_key?('status_last_change') ? n['rasca_status']['GitChk']['CheckGit']['status_last_change'] : "Unknown"
      @last_updated=n['rasca_status']['GitChk']['CheckGit'].has_key?('ctime') ? n['rasca_status']['GitChk']['CheckGit']['ctime'] : "Unknown"
      @last_message=n['rasca_status']['GitChk']['CheckGit'].has_key?('last_message') ? n['rasca_status']['GitChk']['CheckGit']['last_message'] : "Unknown"
-%>
| <%= n.name %> | <%= @last_status %> | <%= @last_updated %> | <%= @last_change %> | <%= @last_message %> |
<%  end -%>
<% end -%>


